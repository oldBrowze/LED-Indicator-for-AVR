# LED-Indicator-library-for-AVR
 Библиотека, позволяющая управлять 4-разрядным семисегментным индикатором с **общим катодом** МК AVR.
Функционал реализован на базе микроконтроллера `ATMega328p` и платформы Arduino UNO.
### Используемое ПО 
* AVR Studio 7.0
 ---
 ### Использование
#### Подключение в программе
```C++
#define LED_UPDATE 4      //скорость обновления разряда
#define LED_COMMON ANODE  //тип индикатора. Общий анод или общий катод
#include "LED_core.hpp"
```
#### Подключение к микроконтроллеру
* **Исходя из того, что при полном включении индикатора, у него будут гореть 8 светодиодов, ток которых суммарно равен `8 * (5 В / 220 Ом) = 0,18 А`, к портам МК его нужно подключать через биполярные транзисторы NPN, максимальный ток коллектора которых больше либо равен току потребления индикатора.**
* Сегменты `a-g` должны быть подключены **через резисторы номиналом 220 Ом** к регистру `PORTD`, начиная с **младшего** разряда;
* Катоды каждого разряда подключаются, начиная со **старшего** разряда; 
    * 1 сегмент, он же старший, должен быть подключен к `PORTD3`
    * 4 сегмент, он же младший, должен быть подключен к `PORTD0`
* Для вывода на экран значения, используется функция
```C++
inline void print_value(const uint16_t &number);
```
***Исходя из того, что библиотека настроена на то, что микроконтроллер тактируется от внешнего кварцевого рзонатора с частотой 16 МГц, то возможна некорректная работа при отличных от этой ситуациях.***


---
 ### Функционал
###### Библиотека использует
* Библиотеки для реализации прерывания по переполнению и `PROGMEM`
```C++
    #include <avr/io.h>
    #include <avr/interrupt.h>
    #include <avr/pgmspace.h>
```
* Весь `PORTD` и весь `PORTB`;
* Нулевой таймер-счетчик `TCCR0` с установкой делителя на `256`;
* Регистр `TIMSK0` для определения прерывания 
* Порт `SREG` для разрешения глобальных прерываний (посредством функциии `sei()`);
###### Планируется реализовать
* Реализация библиотеки путем использования паттерна `Singleton`;
* Обработка исключительных ситуаций при работе с функциями;
* ~~Изменение времени обновление экрана(по умолчанию константно);~~
* ~~Выбор типа индикатора: с общим анодом или с общим катодом;~~
* Полную совместимость с другими видами микроконтроллеров AVR;
* Поддержка `float`-значений;
* Освободить незанятые биты регистра `PORTB`;
* Поддержка `signed`-значений;
* Увеличение возможностей библиотеки;
* Аналог библиотеки для микроконтроллеров `STM` и `PIC`.
